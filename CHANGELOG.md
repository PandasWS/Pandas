# 更新日志

此仙境传说模拟器中值得注意的改动都将被记录到本文档.

本文档遵循 [维护更新日志](https://keepachangelog.com/zh-CN/1.0.0/) 提及的格式标准, 
但并不遵循 [语义化版本](https://semver.org/lang/zh-CN/) 版本号制定标准.

更新日志中不包含 rAthena 的官方改动, 除非开发者认为 rAthena 的改动值得在此重点提出 (例如: 遇到兼容性问题时).

> 若您运行本程序时遇到提示丢失 `VCRUNTIME140.dll` 等文件导致无法启动时, 
> 请下载安装 [Microsoft Visual C++ 2015 Redistributable] 的 x86 版本后重试.

-------------------------------------------------------------------------------

## [v1.2.2] - `2023-07-22`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- 最美的Secret、山有、SSBoyz、HongShin、Renee

### rAthena 重要更新

- 扩充道具商城 (CashShop) 可以陈列的道具上限
- 修正使用 `reloadnpc` 导致的路径缓存错误 (出现 NPC 重名)
- 修正临时技能无法从技能面板中正确清除的问题
- 新增 `setcard` 管理员指令, 用于给身上的装备插卡
- 彻底解决 "Reached limit of unit objects per cell" 错误

### 功能调整

- 在 `Debug` 模式下隐藏玩家数据流转的子网掩码调试信息
- 翻译最新的道具效果调整器说明文档 (感谢 "SSBoyz" 翻译)
- 根据最新的 db 数据更新对应的 sql 文件
- 汉化 `conf/battle/feature.conf` 中的部分选项

### 缺陷修正
- 修正 `getmapspawns` 和 `getmobspawns` 无法获取静态魔物数据的问题 (感谢 "SSBoyz" 反馈)
- 修正 `script_cleararray_pc` 无法清空单元素数组的问题 (感谢 "最美的Secret" 反馈) (#724)
- 修正 `getsameipinfo` 存在的条件判断逻辑错误 (|| 写成了 |)
- 修正 `setmapflag` 指定无参数地图标记会误报的问题 (感谢 "山有" 反馈)
- 修正 `maxaspd` 在脚本首次加载时触发能力重算时无法正确读值的问题

-------------------------------------------------------------------------------

## [v1.2.1] - `2023-06-01`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- HongShin、Renee

### rAthena 重要更新

- 修正 `bSkillCooldown` 无法调整冷却时间超过正负 10 秒的问题

### 功能调整

- 解除对 `Boost Libraries` 的依赖
- 更新 `Github Actions` 配置文件与 `rAthena` 近似 (#717)
- 工程标准升级到 `C++17` 标准
- 升级 `OpenCC` 第三方依赖库到 `v1.1.6` 版本 (#716) 
- 更新 `yaml-cpp` 第三方依赖库到 `v0.7.0` 版本 (#714)

### 缺陷修正

- 解决 Linux 使用 Ctrl+C 会直接中断程序的问题 (#711)

-------------------------------------------------------------------------------

## [v1.2.0] - `2023-05-19`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- 差记性的小北、HongShin、Renee

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.2.0_main.sql`
- 若您启用了 `SQL` 版本的魔物/物品数据, 那么请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.2.0_main_use_sql_db.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### rAthena 重要更新

- 使程序能够兼容 `MariaDB` 数据库
- 在 `Release` 模式下移除加载 `YAML` 数据库时候的进度呈现, 大幅提高启动速度
- 更新 `instance_warpall` 脚本指令, 使之可以指定是否传送死亡单位
- 实装生命体 S 的 250 级支持及其 16 个新技能
- 将人工生命体数据库从 `csv` 转换成 `YAML` 格式
- 实现 12 个魔物技能 (数量较多, 请见技能数据库)
- 修正 `getrefine` 脚本指令在 `OnEquip` / `OnUnequip` 工作异常的问题
- 附魔评级数据库支持对不同精炼等级的道具分别设置成功率
- 实现掉线自动回到副本的原生支持 (主数据库字段更新)
- 修正部分 `NPC` 在使用 `unitwalk` 指令进行移动时会消失的问题
- 调整了复兴后的属性相克伤害表
- 修正克隆体只会受到 1 点伤害的问题
- 地图缓存数据中添加截止 `KRO` 到 `2023-04-05` 的 20 张新地图
- 更新 `unitskilluseid` 和 `unitskillusepos` 脚本指令, 使之可以忽略数据库中定义距离限制
- 更新 `mob_drops.yml` 数据库中的概率定义, 从万分率改成十万分率
- 定义 `NPC` 的时候可以选择默认状态 (`CLOAKED`, `HIDDEN`, `DISABLED`)
- 修正 `PINCODE` (角色选择解密的鼠标密码) 功能异常的问题
- 实装 KRO 在 2021 年第三、第四季度的技改
- 状态数据库支持新的标记位 `RequireNoWeapon`, 可要求没有武器时才能启用状态
- 修正魔物在被玩家发现后会立刻行走的问题
- 实装 `EP17.2` 的 `Sage's Legacy` 系列任务和 4 个副本
- 实装 `EP16.2` 的 `Weekend Memorial Dungeon` 副本
- 实装 `EP16.2` 的 `Illusion of Turtle` 任务
- 实装 `EP16.2` 的 `Illusion of Luanda` 任务
- 实装 `EP16.2` 的 `Illusion of underwater` 任务
- 实装 `EP16.2` 的 `Friday Memorial Dungeon` 任务
- 实装 `EP16.1` 的 `Edda Half Moon In The Daylight` 副本
- 实装 `Einbech dungeon 3` 任务
- 实装 `nif_dun, mag_dun03` 任务

### 功能调整

- 重构拓展地图标记的代码逻辑使之能更方便的支持多参数 (#706)
- 调整关于 `OnPCStatCalcEvent` 事件的说明

### 缺陷修正

- 修正部分脚本指令无法触发 `OnPCUseSkillFilter` 事件的问题 (感谢 "差记性的小北" 反馈) (#685)
- 修正 `Release` 模式下生成转储文件可能会失败的问题

-------------------------------------------------------------------------------

## [v1.1.19] - `2023-01-26`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- 差记性的小北、山有、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.19_main.sql`
- 若您启用了 WEB 接口服务器, 那么请在 WEB 接口数据库导入:
	- `sql-files\web\upgrades\upgrade_to_1.1.19_web.sql`
	- 注意: 本次更新必须先执行主数据库的升级
	- 可选: 确认正常后可以移除 `recruitment` 数据表

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### rAthena 重要更新

- 实现 `roulette` GM 指令用于打开乐透大转盘界面 
- 使得信息查询指令 (例如: `@mi`) 的返回结果可关联物品连接
- 移除从 `2017` 年就标记过时的 `unitemote` 脚本指令
- 实现 `duplicate` 脚本指令, 用于实现 NPC 的复制
- 实装外挂检测器 (`Macro Detection`) 机制
- 实装动态 NPC 机制 (`Dynamic NPC`)
- 将道具商城数据库文件 (`item_cash_db.txt`) 转换成 YAML 格式
- 实现 `add_reputation_points` 脚本指令, 用于增加指定的声望点数
- 实现对新版客户端中公会面板直飞公会城堡的支持
- 当角色所在地图无效的情况下进入游戏时, 能支持选择落脚点
- 支持生成声望交互界面 (`Reputation UI`) 所需要的 bson 文件
- 支持生成道具交易限制文件 (`itemmoveinfov5.txt`)

### 功能调整

- 使 `map-server-generator` 能输出帮助信息 (#668)
- 完全汉化 `feature.conf` 中的选项注释 (#674)
- 完全汉化 `battle.conf` 中的选项注释 (#676)
- 完全汉化 `client.conf` 中的选项注释 (#677)
- 完全汉化 `drops.conf` 中的选项注释 (#680)

### 缺陷修正

- 修正 `prompt` 选择取消后特定情况下会导致报错的问题 (感谢 "差记性的小北" 反馈) (#678)
- 修正 `setunitdata` 的调整会继承到下一次重生的问题 (感谢 "差记性的小北" 反馈) (#671)
- 修正读取 GRF 文件时进行编码探测导致内存溢出的问题 (#665)
- 修正当过滤器事件不存在时报 `nullpo` 错误 (感谢 "山有" 反馈) (#662)
- 修正脚本控制的商店在特定情况下存在的报错问题 (感谢 "HongShin" 反馈) (#682)

-------------------------------------------------------------------------------

## [v1.1.18] - `2022-10-29`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- chaoyenpo、差记性的小北、香草、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

- 请在日志数据库导入:
	- `sql-files\logs\upgrades\upgrade_to_1.1.18_logs.sql`
- 若您启用了 WEB 接口服务器, 那么请在 WEB 接口数据库导入:
	- `sql-files\web\upgrades\upgrade_to_1.1.18_web.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### rAthena 重要更新

- 实装附魔精炼交互界面 (Enchant UI)
- 实装道具箱子选择界面 (Item Package Selection)
- 实现 `guild_skill_relog_type` 战斗配置选项, 用于控制公会技能在会长重登后的冷却策略
- 实现 `petautobonus` 系列脚本指令, 允许魔物实现和玩家 `autobonus` 类似的功能
- 支持 `2022` 的新客户端封包 (PACKETVER 可以指定 2022 年的客户端了)
- 实现 `map-server-generator` 工程用来生成客户端需要的导航数据

### 新增功能

- 实现 `OnPCFavoriteAddFilter` 过滤器事件, 当玩家准备将道具移入收藏栏位时触发 [香草] (#542)
- 实现 `OnPCFavoriteDelFilter` 过滤器事件, 当玩家准备将道具从收藏栏位移出时触发 [香草] (#543)

### 功能调整

- 移除 `ConfigParser.py` 中引入了多余的 `_tkinter` 模块 (感谢 "chaoyenpo" 修正)
- 移除 `breakpad` 在没有链接 `libcurl` 静态库时的警告信息
- 在 `Linux` 平台下进行编译时对编译器的版本进行必要的检查和警告提示
- 优化 `map-server-generator` 的工作流程, 使之能在运行时按需自动创建输出目录

### 缺陷修正

- 修正 `getunittarget` 脚本指令的返回值不正确的问题
- 修正 `laphine` 系列指令在特定情况下会引发崩溃的问题 (感谢 "差记性的小北" 反馈)

-------------------------------------------------------------------------------

## [v1.1.17] - `2022-09-13`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- Oysica、Sense、香草、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.17_main.sql`
- 若您启用了 WEB 接口服务器, 那么请在 WEB 接口数据库导入:
	- `sql-files\web\upgrades\upgrade_to_1.1.17_web.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 实现 `OnPCCartAddFilter` 过滤器事件, 当玩家准备将道具从背包存入手推车时触发 [香草] (#544)
- 实现 `OnPCCartDelFilter` 过滤器事件, 当玩家准备将道具从手推车取回背包时触发 [香草] (#545)

### 缺陷修正

- 修正使用 `utf8 / utf8mb4` 编码时无法根据语言转换成对应 ANSI 编码的问题
- 修正某些情况下 getstoragelist 会意外打开仓库界面的问题 (#642)
- 修正 `battleignore` 脚本指令工作异常的问题 (感谢 "Sense" 反馈) (#641)
- 修正因技能而触发 `OnPCHarmedExpress` 导致的事件执行错误 (#643)
- 使 `getstoragelist` 系列指令不必非得在无坐标的浮动 NPC 中使用 (#644)
- 当 `script_state` 被释放的时候, 同时清理玩家多层脚本堆栈备份清单中的副本 (#640)
- 参考 "RO幻想厅" 的数据, 补充繁体中文情况下魔物名称翻译表 (感谢 "Oysica" 提交) (#645)

-------------------------------------------------------------------------------

## [v1.1.16] - `2022-08-10`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- 香草、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 风险提示

- rAthena 重新调整了物理攻击的算法使之与官服匹配, 可能会导致玩家反馈物理伤害发生变化

### 新增功能

- 使 `bonus2 bSkillNoRequire` 效果调整器可以移除 AP/APRATE 施放條件 (#622)

### 缺陷修正

- 修正使用 `getinventorylist` 导致地图服务器崩溃的低级错误 (感谢 "香草" 反馈) (#634)

-------------------------------------------------------------------------------

## [v1.1.15] - `2022-08-08`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- Oysica、Messiah、DDWT、jian916、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 新增功能

- 完全支持读取 UTF8 (包含或者不含BOM) 编码的脚本、配置和数据文件 (#623)
- 实现 `getcartinfo` 脚本指令, 用于查询指定手推车序号的道具详细信息
- 实现 `getguildstorageinfo` 脚本指令, 用于查询指定公会仓库序号的道具详细信息
- 实现 `getstorageinfo` 脚本指令, 用于查询指定个人仓库/扩充仓库序号的道具详细信息

### 功能调整

- 当使用 `utf8` / `utf8mb4` 作为数据库编码时不再给予警告 (#620)
- 当 YAML 数据文件中不存在 `Body` 节点时也依然输出结尾信息 (#625)
- 调整脚本引擎在 `add_str` 中分配内存的步进空间, 降低内存重分配次数 (#632)

### 缺陷修正

- 修正仓库存取事件打断后 `Alt + 鼠标右键` 快捷键失效的问题 (感谢 "香草" 修正)
- 修正仓库存取事件打断后手推车物品无法拖拽的问题 (感谢 "香草" 修正)
- 修正 `spawn_level[]` 字段返回值不符合预期的问题 (感谢 "Oysica" 反馈) (#618)
- 修正 `UTF8-BOM` 字符转换成 `BIG5` 时存在多余反斜杠的问题 (感谢 "DDWT", "jian916" 反馈) (#619)
- 修正拥有 `BSF_REM_ON_LOGOUT` 标记位的 `bonus_script` 极少数情况下会在重登后生效的问题 (感谢 "香草" 反馈) (#626)
- 修正 `breakpad` 在 `Ubuntu 22.04 LTS` 无法被 `gcc-11` 顺利编译的问题 (感谢 "Messiah" 反馈) (#628)
- 修正 `sprintf` 脚本指令无法格式化 int64 数值的问题 (#631)
- 修正触发 `str_buf` 扩容后, 所有 `st->funcname` 保存的指令名发生错误的情况 (#633)
- 修正复兴前的状态数据库丢失了部分字段导致的一系列问题 (感谢 "Oysica" 反馈) (#629)

-------------------------------------------------------------------------------

## [v1.1.14] - `2022-07-17`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- Oysica、Messiah、DDWT、人鱼姬的思念、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 新增功能

- 实现 `getcartlist` 脚本指令, 用于获取手推车中的物品信息
- 实现 `getguildstoragelist` 脚本指令, 用于获取公会仓库中的物品信息
- 实现 `getstoragelist` 脚本指令, 用于获取个人仓库中的物品信息 (支持扩充仓库)
- 改进 `getinventorylist` 系列脚本指令, 使之可以控制想查询的数据类型
- 实现 `OnPCHarmedExpress` 实时事件, 当玩家受到伤害并即将进行结算时触发 [人鱼姬的思念] (#533)

### 功能调整

- 移除用于优化 YAML 文件读取速度的疾风缓存机制, 已结束历史使命 (#610)
- 优化加载与解析 YAML 文件时出现的一些报错体验

### 缺陷修正

- 修正背包剩余空间容量判断错误的问题
- 修正在特定配置下炼金术士召唤部分魔物时会导致地图服务器崩溃的问题 (感谢 "Oysica" 指出) (#609)
- 修正在 Linux 非英文环境下编码转换失败的问题 (感谢 Messiah 反馈) (#611)
- 修正 `reloadbarterdb` 没有调用父类 clear 导致数据没被重置的问题 (#606)
- 修正客户端重置快捷键后 WEB 接口服务器没有删除对应记录的问题 (#605)
- 修正 MVP 被系统击杀时会出现 nullpo 提示的问题 (#602)
- 修正 `getmapspawns` 和 `getmobspawns` 的说明错误 (感谢 "DDWT" 指出) (#603)
- 修正已向角色服务器请求获取 'd' 个公会城堡信息的错误

-------------------------------------------------------------------------------

## [v1.1.13] - `2022-06-19`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- 香草、忘我、人鱼姬的思念、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

- 请在日志数据库导入:
	- `sql-files\logs\upgrades\upgrade_to_1.1.13_logs.sql`
- 若您启用了 `SQL` 版本的魔物/物品数据, 那么请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.13_main_use_sql_db.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 实现 `reloadlaphinedb` 管理员指令, 用于重新加载 Laphine 数据库 (#596)
- 实现 `reloadbarterdb` 管理员指令, 用于重新加载以物易物数据库 (#597)
- 实现 `getbossinfo` 脚本指令, 用于查询 BOSS 魔物重生时间及其坟墓等信息 (#598)
- 实现 `whodropitem` 脚本指令, 用于查询指定道具会从哪些魔物身上掉落 (#591)
- 实现 `OnPCStorageAddFilter` 过滤器事件, 当玩家准备将道具存入仓库时触发过滤器 (感谢 "香草" 实现) (#539)
- 实现 `OnPCStorageDelFilter` 过滤器事件, 当玩家准备将道具取出仓库时触发过滤器 (感谢 "香草" 实现) (#540)

### 功能调整

- 同步 kRO 截止 `2022-06-13` 可用的 NPC 外观编号范围 (#595)
- 使 `OnMobDropItemExpress` 能够返回即将掉落道具的魔物的游戏单位编号 (#593)
- 使 `OnPCViewEquipFilter` 可以知道被查看角色是否允许其他人看他的装备 (#594)

### 缺陷修正

- 修正 `bonus3 bAddEffOnSkill` 中 `PC_BONUS_CHK_SC` 带入检测参数错误的问题 (感谢 "忘我" 反馈) (#575)

-------------------------------------------------------------------------------

## [v1.1.12] - `2022-05-15`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- Mr.Siu、SSBoyz、人鱼姬的思念、secretdataz、Sky、小林、HongShin、Renee

### 特别公告

熊猫模拟器的官网也已经正式上线了, 欢迎各位朋友前往访问! [前往访问](https://pandas.ws)

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 风险提示

此版本距离上个版本间隔了两个月时间,
这期间主要的原因是我们的上游项目 rAthena 进行了一项较大改动.

它将代码中全部状态 (可以理解为游戏里的 BUFF) 从代码中抽离成一个 status.yml 配置文件,
这会极大赋予用户随意调整状态工作细节的能力, 但是也将 rAthena 带入了缺陷频出的一段不稳定时期.

经过这段时间的沉淀, 相信应该已经到了一个比较平衡的情况,
但可能也依然存在社区和我们没有发现的问题, 如果有发现请随时上报给开发者.

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.12_main.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

特别注意: 本次更新中 `skill_db.yml` 和新增的 `status.yml` 要注意同步, 特别是老用户.

### 新增功能

- 实现 `getrateidx` 脚本指令, 用于根据权重随机获取一个数值型数组的索引序号 (#555)
- 实现用于获取手推车负重信息的 `CartWeight` 和 `MaxCartWeight` 脚本常量 (感谢 "人鱼姬的思念" 实现) (#503)
- 实现 `OnPCClickTombFilter` 触发器事件, 当玩家点击魔物墓碑时触发 (感谢 "人鱼姬的思念" 实现) (#510)
- 实现 `OnPCTalkExpress` 实时事件, 当玩家往聊天框发送信息时触发 (感谢 "人鱼姬的思念" 实现) (#511)
- 使得 `getunitdata` / `setunitdata` 可以读取或设置特定魔物单位的经验值 (感谢 "人鱼姬的思念" 实现) (#526)

### 功能调整

- 完善对于 `script4each` 字符串转义的说明 (感谢 "小林" 指出) (#553)
- 更新繁体中文的技能名称翻译对照表 (感谢 "SSBoyz" 提交) (#563)
- 对疾风缓存机制进行重构, 并调整各类声明和定义的位置 (#565)
- 修正交叉切换 Debug / Release 方案进行编译时报错的问题 (#564)
- 默认禁止在角色、公会、队伍名称中使用单引号 (感谢 "SSBoyz" 建议) (#568)

### 缺陷修正

- 修正魔物死亡但客户端没移除魔物单位的一种新情况 (感谢 "Mr.Siu" 提供环境配合验证) (#562)
- 修复使用 RODEX 系统发送已插卡的装备会导致邮件发送失败的问题 (感谢 "SSBoyz" 反馈) (#541)
- 修正写入公会仓库日志时没有对角色名进行转义处理的问题 (感谢 "小林" 反馈) (#552)
- 修正异步查询数据库指令执行过程中 `reloadscript` 可能会导致崩溃的问题 (#567)

-------------------------------------------------------------------------------

## [v1.1.11] - `2022-03-13`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- SSBoyz、人鱼姬的思念、Oysica、红狐狸、Sky、secretdataz、尐駒頭寶寶、zh82558223、HongShin、Renee

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

- 请在日志数据库导入:
	- `sql-files\logs\upgrades\upgrade_to_1.1.11_logs.sql`
- 若您启用了 `SQL` 版本的魔物/物品数据, 那么请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.11_main_use_sql_db.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 解锁仓库和背包在封包层面的最大容量限制, 使其容量可达到 2000 格 (#515)
- 使 `setunitdata` 针对魔物单位的基础状态设置不会被能力过程直接洗刷掉 (#525)
- 实现 `itemdb_warning_policy` 选项, 用于禁用加载物品数据库时的一些警告信息 (#509)
- 实现 `unitspecialeffect` 脚本指令, 使指定游戏单位可以显示某个特效 [人鱼姬的思念] (#512)
- 实现 `next_dropitem_special` 脚本指令, 用于对下一个掉落到地面上的物品进行特殊设置 (#517)
- 实现 `getgradeitem` 脚本指令, 用于创造带有指定附魔评级的道具 (#516)
- 实现 `bAbsorbDmgMaxHP2` 效果调整器, 单次承伤不超过总血量的 n% (感谢 "secretdataz" 实现) (#521)
- 实现 `bAbsorbDmgMaxHP` 的 Bonus2 版本, 单次承伤超过总血量的 n% 时最多只造成总血量 x% 的伤害 (#523)
- 实现 `mob_default_damagemotion` 选项, 用于控制魔物被攻击时受伤动画的默认播放时长 (#524)

### 功能调整

- 当 YAML 数据库在加载过程中出现报错或者警告时跳过生成缓存文件, 避免掩盖问题
- 针对 `yaml2sql` 和 `yamlupgrade` 等辅助工具项目直接禁用疾风缓存 (无意义, 也不需要)
- 使建立疾风缓存数据之间的依赖关系, 当自己所需的其他数据库内容变更时自己的缓存也一起过期
- 更新 `sql-files` 说明文档, 添加关于 WEB 接口数据库的说明
- 根据仙境全书的职业名称重新翻译相关文件 (#536)

### 缺陷修正

- 修正魔物获得异常状态时的伤害数字丢失问题 (感谢 "Sky" 反馈) (#502)
- 修正生成内存泄露日志文件或其他文本文件时程序崩溃的问题 (#508)
- 修正变态服扩展包部分字段的取值范围限制没被解除的问题 (#507)
- 修正两处近期反馈相对比较集中的地图服务器崩溃 (#518)
- 修正背包、仓库、手推车在存储期间发生道具增减会导致道具丢失的问题 (#513)
- 修正莎拉卡片 (Sarah_Card) 的效果 (感谢 "SSBoyz" 指出) (#522)
- 修正 `getskillinfo` 脚本指令在查询技能数据时可能存在错误的问题 (#527)
- 修正 `stylist` 功能在花费金币时 `zenylog` 写入失败的情况 (#537)
- 修正玩家在重新计算技能树时的一处潜在崩溃 (#538)

-------------------------------------------------------------------------------

## [v1.1.10] - `2022-02-11`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- SSBoyz、红狐狸、(,,• ₃ •,,) 猫丶、香草、吃三碗、HongShin、Renee

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.10_main.sql`
- 请在日志数据库导入:
	- `sql-files\logs\upgrades\upgrade_to_1.1.10_logs.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### rAthena 重要更新

- 实装六大职业系的四转职业 (不含拓展职业, 感谢 "Rytech" 的 4CrAM 项目)
- 支持截止目前最新可用的 `2021-11-17` 客户端封包 (感谢 "Lemongrass" 实现)
- 实装 `Stylist` 用户交互界面 (感谢 "Lemongrass" 实现)
- 实装 `BarterShops` 以物易物商店 (感谢 "Lemongrass" 实现)

### 新增功能

- 实现 `getquesttime` 脚本指令, 用于查询角色指定任务的时间信息 (#495)
- 实现 `query_sql_async` 和 `query_logsql_async` 异步数据库查询脚本指令 (感谢 "inhyositsu" 实现) (#496)
- 使 `getinventoryinfo` / `setinventoryinfo` 能够读写道具的附魔评级

### 功能调整

- 此版本开始默认支持客户端从 `20180620` 调整为 `20211117`
- 废弃以前的背包拓展机制, 使用 rAthena 官方实现的背包拓展机制
- 完善召唤师, 拳皇, 猎灵士 `176~200` 级的 HP/SP 数据 (感谢 "SSBoyz" 提交)
- 更新 KRO 在 `2021-05-18` 发布的属性相克表 (感谢 "SSBoyz" 提交) (#494)
- 熊猫官方决定将 `barters.yml` 数据库从 npc 目录移动回 db 目录

### 缺陷修正

- 修正获取道具分组的随机算法权重不符合预期的问题 (感谢 "红狐狸" 指出) (#476)
- 修正转职到没有基础攻速数据的职业时会导致地图服务器崩溃的问题 (感谢 "(,,• ₃ •,,) 猫丶" 反馈)
- 修正 `getinstancevar` / `setinstancevar` 传递无效副本编号会导致地图服务器崩溃的问题 (感谢 "香草" 反馈) (#473)
- 修正 WEB 接口服务器无法同时保存贩卖和采购商店配置的问题 (感谢 "吃三碗" 反馈) (#477)
- 修正 WEB 接口服务器在繁体中文情况下的编码处理问题 (感谢 "吃三碗" 反馈) (#479)

-------------------------------------------------------------------------------

## [v1.1.9] - `2021-12-29`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- HongShin、Renee、306789

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

推荐使用 v1.1.8 的用户都升级到 v1.1.9 上来.

### 缺陷修正

- 紧急修复 `cloakonnpc` 指令失效的问题, 优化多处光环系统的细节 (感谢 "306789" 反馈) (#468)

-------------------------------------------------------------------------------

## [v1.1.8] - `2021-12-26`

### 特别感谢

在此版本的开发过程中以下朋友提供了各种形式的支持, 特此鸣谢 (排名不分先后).

- 聽風、HongShin、Renee、小纪、人鱼姬的思念、ghost

### 加入 Discord 社区

我们在 Discord 开设了 PandasWS 官方社区, 欢迎各位朋友加入! [猛击此处立刻加入](https://discord.gg/9bEfrPPruj)

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.8_main.sql`
- 若您启用了 `SQL` 版本的魔物/物品数据, 那么请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.8_main_use_sql_db.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 实现 `bFinalAddRace` 调整器, 用于控制在使用 bf 攻击 r 种族的目标时增加 x% 的伤害 [聽風] (#422)
- 实现 `bFinalAddClass` 调整器, 用于控制在使用 bf 攻击时 c 类型目标时增加 x% 的伤害 [聽風] (#422)
- 实现 `bStatusAddDamage` 调整器, 使用 bf 攻击拥有 sc 状态的目标时有 r/100% 的概率使伤害增加 n [聽風] (#423)
- 实现 `bStatusAddDamageRate` 调整器, 使用 bf 攻击拥有 sc 状态的目标时有 r/100% 的概率使伤害增加 n% [聽風] (#423)
- 实现 `bSkillNoRequire` 调整器, 用于解除 sk 技能中由 n 指定的前置施法条件限制 [聽風] (#412)
- 实现 `sleep3` 脚本指令, 用于休眠一段时间再执行后续脚本 (与 sleep2 类似但忽略报错) [人鱼姬的思念] (#452)
- 实现 `boss_monster` 脚本指令, 召唤魔物并使之能被 BOSS 雷达探测 [人鱼姬的思念] (#463)
- 实现 `OnPCDropItemFilter` 过滤器, 当玩家准备丢弃或掉落道具时触发 [人鱼姬的思念] (#460)
- 实现 `OnPCMerCallExpress` 实时事件, 当玩家成功召唤出佣兵时触发 [HongShin] (#435)
- 实现 `OnPCMerLeaveExpress` 实时事件, 当佣兵离开玩家时触发 [HongShin] (#434)
- 实现 `noattack` 地图标记, 用于禁止此地图上的任何单位进行普通攻击 [HongShin] (#438)
- 实现 `noattack2` 地图标记, 用于禁止此地图上指定类型的单位进行普通攻击 [HongShin] (#438)
- 实现 `remove_manhole_with_status` 选项, 用于控制"人孔"被移除时被捕获玩家是否立即脱困 (#457)
- 使疾风缓存能支持 `SkillTreeDatabase` 技能树数据库 (DEBUG 提速约 1200 毫秒) (#466)
- 使疾风缓存能支持 `JobDatabase` 职业数据库 (DEBUG 提速约 7800 毫秒) (#466)

### 功能调整

- 更新 `Boost C++ Libraries 到 1.78.0` 以便兼容 `Visual Studio 2022` (#464)

### 缺陷修正

- 修正 `detachrid` 之后可能导致其他 NPC 消失的问题 (#428)
- 修正公会踢掉离线玩家后, 地图服务器需要重连角色服务器的问题 (感谢 "小纪" 反馈)
- 修正视野内携带光环的玩家死亡后复活光环会被重复绘制的问题
- 修正事件名称大小写导致实时事件触发异常 (感谢 "HongShin" 指出)
- 修正光环机制导致 `cloakonnpc` 无效的问题 (感谢 "ghost" 反馈) (#461)
- 修正六维属性过高会导致面板中的部分数值显示异常的问题
- 修正 `pc_setpos` 在特殊操作情况下可能会导致崩溃的问题 (感谢 "HongShin" 反馈) (#456)
- 修正无法对宠物应用光环的问题 (感谢 "HongShin" 反馈) (#455)

-------------------------------------------------------------------------------

## [v1.1.7] - `2021-11-15`

### 升级提示

- 若您启用了 WEB 接口服务器, 那么请在 WEB 接口数据库导入:
	- `sql-files\web\upgrades\upgrade_to_1.1.7_web.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 实现冒险家中介所 (WEB-SERVER 接口支持以及申请入队功能) (#444)
- 实现用于读写商店配置信息的 `MerchantStore` 接口 (#442)
- 实现 `OnPCAttackExpress` 实时事件, 当玩家发起攻击并即将进行结算时触发 [聽風] (#408)
- 实现 `bRebirthWithHeal` 调整器, 当玩家死亡时有机率复活并恢复HP/SP [聽風] (#409)
- 实现 `bAddSkillRange` 调整器, 用于增加指定技能的攻击距离 [聽風] (#411)

### 功能调整

- 重新整理引用关系以便可以在 `defines_pre.hpp` 中定义 `PACKETVER` 等选项
- 完善 `bonus_script` 脚本指令返回值的说明 (感谢 "HongShin" 反馈)

### 缺陷修正

- 改善 WEB 接口服务器对中文客户端的支持, 解决已知的繁体中文乱码情况 (#436)
- 修正角色配置接口在同账号下的不同角色信息会相互覆盖的问题 (#441)

-------------------------------------------------------------------------------

## [v1.1.6] - `2021-09-25`

### 升级提示

- 使用 `web-server` 工程需要将 `PACKETVER` 调整为大于等于 `20200300` 的版本
- 使用 `web-server` 需要导入 `sql-files\web\creation\01.web.sql` 建立所需的数据库表

### 新增功能

- 将 `web-server` 工程整合进来, 以便提供客户端所需配套的 WEB 接口服务 (#432)
- 实现 `getcalendartime` 脚本指令, 用于获取下次出现指定时间的 UNIX 时间戳 (#400)
- 实现 `getmapspawns` 脚本指令, 用于获取指定地图的魔物刷新点信息 (#401)
- 实现 `getmobspawns` 脚本指令, 用于查询指定魔物在不同地图的刷新点信息 (#402)
- 实现 `getskillinfo` 脚本指令, 用于获取指定技能在技能数据库中所配置的各项信息 (#429)
- 使 `setuntdata` / `getunitdata` 支持设置指定魔物的承伤倍率 (感谢 "人鱼姬的眼泪" 建议) (#416)
- 实现 `OnPCGuildLeaveFilter` 过滤器, 当玩家主动离开或被驱逐出公会时触发 [聽風] (#419)
- 实现 `OnPCGuildCreateFilter` 过滤器, 当玩家准备创建公会时触发过滤器 [聽風] (#417)
- 实现 `OnPCGuildJoinFilter` 过滤器, 当玩家即将加入公会时触发过滤器 [聽風] (#418)
- 实现 `OnPCPartyCreateFilter` 过滤器, 当玩家准备创建队伍时触发过滤器 [聽風] (#413)
- 实现 `OnPCPartyJoinFilter` 过滤器, 当玩家即将加入队伍时触发过滤器 [聽風] (#414)
- 实现 `OnPCPartyLeaveFilter` 过滤器, 当玩家准备离开队伍时触发过滤器 [聽風] (#415)
- 实现 `noslave` 地图标记, 用于禁止魔物在指定地图上召唤随从 (#424)
- 实现 `nobank` 地图标记, 用于禁止玩家在地图上使用银行系统 [聽風] (#426)
- 实现 `nouseitem` 地图标记, 用于禁止玩家在地图上使用消耗型物品道具 (#425)
- 实现 `hidedamage` 地图标记, 用于隐藏此地图上任何攻击的实际伤害数值 (#427)

### 功能调整

- 将 `MAX_INVENTORY` 废弃并改成用 `G_MAX_INVENTORY` 或 `P_MAX_INVENTORY` (#431)
- 汉化和校正部分配置文件的注释信息

### 缺陷修正

- 修正 `@item` 等指令只能使用 `AegisName` 来创造道具的问题 (#420)

-------------------------------------------------------------------------------

## [v1.1.5] - `2021-08-14`

### 升级提示

- 若您启用了 `SQL` 版本的魔物/物品数据, 那么请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.5_main_use_sql_db.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 使 `announce` 脚本指令发送的公告信息能够支持双击私聊发送者 (#396) (感谢 "Sense" 实现)
- 使墓碑中的魔物名称能尊重 `override_mob_names` 战斗配置选项的设置
- 使疾风缓存支持 item_group_db.yml, item_randomopt_db.yml, item_randomopt_group.yml 数据库
- 修正在 Liunx 平台上对 `big5` 编码的支持 (感谢 "s11005349" 反馈) (#398)

### 功能调整

- 调整缓存的过期策略, 改变结构体大小将强制缓存过期 (#389)
- 提升 SQL 版物品数据库中 price_buy 和 price_sell 的字段类型 (感谢 "懒猪" 反馈)
- 调整 csv2yaml 转换工具的路径处理细节, 并汉化部分终端错误提示文本

### 缺陷修正

- 修正 `script_instancegetid` 中的一处空指针崩溃 (感谢 "VanillaIRV" 反馈) (#387)
- 修正 `mail_attachment_weight` 选项在特定操作顺序下无效的问题 (感谢 "qsc7831449" 反馈)
- 发送邮件之前, 对附件中的道具进行更加严格的检查 (#392)
- 强化邮件系统的参数校验和空指针判断, 避免特殊操作导致地图服务器崩溃 (#388)
- 修正在不支持乐透大转盘机制的客户端上会出现内存泄露的问题
- 使 Linux 平台上输出日志文件时, 字符编码能与终端信息的输出编码一致 (感谢 "余伯芒" 反馈)

-------------------------------------------------------------------------------

## [v1.1.4] - `2021-07-18`

### 新增功能

- 实现 `OnMobDropItemExpress` 实时事件, 当魔物即将掉落道具时触发 (#382)

### 功能调整

- 调整 `item_properties.yml` 以匹配正确的 YAML 配置风格, 不再使用掩码 (#379) 
- 在 Linux 环境下 pipenv 不再安装 `pdbparse` 模块

### 缺陷修正

- 修正逐影在“抄袭/复制”技能后角色服务器可能会丢失该角色全部技能的问题 (#384)
- 修正 `WM_REVERBERATION` 被魔物使用时会导致地图服务器崩溃的问题
- 使用更可靠的方式来更新定时器指向的游戏单位编号 (#380)

-------------------------------------------------------------------------------

## [v1.1.3] - `2021-07-05`

### 新增功能

- 使程序启动时能显示编译时确定的工作模式
- 丰富编译、打包、签名存储环节的可配置项, 以便进行多项目管理 (#374)

### 缺陷修正

- 修正疾风引擎导致部分战斗配置选项无效的问题 (#375)
- 缓解魔物死亡但客户端没移除魔物单位的问题
- 修正邮件拥有多个道具附件时, 特定情况下背包槽位计算错误的问题 (#376)
- 解决复兴后部分卡片修正被应用了两次的问题 (#377)
- 修正版本号批量修改辅助脚本无法改变多位数版本号的问题

-------------------------------------------------------------------------------

## [v1.1.2] - `2021-06-21`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.2_main.sql`
- 请在日志数据库导入:
	- `sql-files\logs\upgrades\upgrade_to_1.1.2_logs.sql`
- 由于 `msg_conf` 中地图服务器的消息编号有所调整, 请注意使用最新的消息数据库

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 实装 20181031 以及更新版本客户端中的背包扩容机制 (#372)
- 使光环机制能支持非持久型特效, 能够定时对特效进行重播
- 在封包版本大于等于 20181002 的客户端中避免应用光环时出现闪烁
- 新增 `maxaspd` 地图标记, 用于限制地图上单位的最大攻击速度
- 实现 `batrec_autoenabled_unit` 选项, 用于配置有哪些单位默认开启战斗记录
- 增加 `hide_server_ipaddress` 选项, 可控制不主动返回服务器的 IP 地址给到客户端
- 增加对负载均衡业务中健康监控的处理策略

### 功能调整

- 将 `OnPCUseSkillEvent` 调整为需技能成功咏唱完毕后再触发
- 将熊猫模拟器自定义消息编号区段的起始编号从 2000 调整到 3000 避免与 4CrAM 冲突
- 调整清理项目时的自定义规则, 使其能移除 exp 和 lib 文件
- 使翻译辅助脚本能处理 mob_db.yml 文件
- 移除 `OnBatrecFreeExpress` 事件, 因为存在价值比较有限且存在性能问题
- 新增与调整大约 3000 条繁体中文物品名称对照表 (感谢 "小樂" 和 "HongShin" 提交) (#368)

### 缺陷修正

- 修正生命体死亡或安息后没有自动清空战斗记录的问题 (感谢 "HongShin" 测试)
- 修正战斗记录会导致 BOSS 雷达无法持续生效的问题 (感谢 "Jian916" 反馈) (#369)
- 修正消息文本中的格式化占位符错误 (导致使用 @itemlist 可导致地图服务器崩溃的问题)

-------------------------------------------------------------------------------

## [v1.1.1] - `2021-04-18`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.1_main.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 实现 `OnPCEnterMapExpress` 实时事件, 当玩家进入或切换地图时触发
- 实现 `OnPCUseReviveTokenFilter` 过滤器, 当玩家使用原地复活之证时触发
- 实现 `OnUnitKillExpress` 实时事件, 当某个单位被击杀时触发
- 实现 `OnPCUseOCIdentifyFilter` 过滤器, 当玩家使用一键鉴定时触发
- 实现 `getunittarget` 脚本指令, 用于获取指定单位当前正在攻击的目标单位编号
- 实现 `unlockcmd` 脚本指令, 用于解锁实时事件和过滤器事件中的指令限制
- 实现 `login` 脚本指令, 用于将指定的角色以特定的登录模式拉上线 (#354)
- 实现战斗记录机制并提供一系列脚本函数辅助构建输出 / 承伤排行榜 (#352)
- 拓展与 `bonus_script` 相关的脚本指令集 (引入唯一编号, 以及 5 个脚本指令) (#358)
- 拓展 `unitexists` 脚本指令, 增加可选参数用于要求目标单位必须存活才认为其存在
- 实现 `always_trigger_npc_killevent` 选项, 就算魔物有自定义死亡事件也能触发 OnNPCKillEvent
- 实现 `always_trigger_mvp_killevent` 选项, 就算 MVP 魔物有自定义死亡事件也能触发 OnPCKillMvpEvent

### 功能调整

- 完成绝大部分消息文件对繁体中文的支持 (#355)
- 将 `OnPCProgressAbortEvent` 改换成 `OnPCProgressAbortExpress` 实时事件
- 将全部事件名称以 Filter 结尾的过滤器事件调整为立刻执行 (不会被排入事件队列)
- 调整部分辅助脚本的工作逻辑, 减少流程阻碍
- 调整 `viewequip` 脚本指令的文档说明
- 调整 `copynpc` 指令的说明错误 (感谢"人鱼姬的思念"指出)

### 缺陷修正

- 修正 `maxdmg_skill` 和 `maxdmg_normal` 无法生效的问题 (感谢 "HongShin" 指出)
- 修正 FAW 魔法傀儡 (技能编号: 2282) 重复扣减原石碎片的问题 (#353)
- 修正 `progressbar` 期间使用 `@load` 或 `@jump` 会导致角色传送后无法移动的问题
- 修正 `progressbar` 期间使用 `@refresh` 会导致角色卡住的问题 (感谢"HongShin"指出)
- 修正 `mobremove` 指令会破坏魔物刷新点的问题 (感谢"喵了个咪"指出)
- 修正角色素质过高会导致无法召唤元素精灵的问题 (感谢 "HongShin" 反馈)
- 修正六维属性为负数时会导致角色面板数值溢出的问题 (感谢 "Renee" 反馈)
- 修正被踢下线的挂店角色在特定操作下会导致挂店数据不可信的问题
- 修正两处在 Ubuntu 下无法使用 GCC 编译通过的问题
- 修正辅助脚本在构建环境时会有多余的终端窗口没有立刻退出的问题

-------------------------------------------------------------------------------

## [v1.1.0] - `2021-02-08`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.1.0_main.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

- 由于 `Boost` 依赖项目变化, 请使用源码的同学重新编译 `3rdparty\boost` 工程
- 本次 `rAthena` 官方整合了多个物品数据文件到 `item_db.yml` 单文件中
- 本次 `rAthena` 官方提升 `quest_db.yml` 的数据版本 (从 1 调整为 2)
- 你在 `db\import\quest_db.yml` 中的 `Version` 应该从 1 调整为 2, 否则会有警告

### 特别提示

- rAthena 的调整同时也大幅改变了 SQL 版本物品数据库的字段结构
- 使用 SQL 版物品数据库的用户阅读: `sql-files/README.md`

### 新增功能

- 实现疾风缓存机制, 大幅提高缓存后加载 YAML 数据库的速度 (#336)
- 实现 `bNoFieldGemStone` 调整器, 可以让元素领域技能无需消耗魔力矿石 (#332)
- 支持读取 UTF8-BOM 的 libconfig 配置文件 (#348)

### 功能调整

- 更新繁体中文的物品翻译对照表 (感谢 Renee 和 HongShin) (#340)
- 汉化部分战斗配置文件的注释选项 (#343 | #345)

### 缺陷修正

- 修正复兴后 "魔术子弹"(GS_MAGICALBULLET) 的伤害溢出问题 (#331)
- 修正一处没有将指针置空导致的崩溃问题 (感谢 Renee / HongShin 协助) (#346)

-------------------------------------------------------------------------------

## [v1.0.9] - `2021-01-29`

### 特别提示

- 建议所有使用 v1.0.8 的用户升级到 v1.0.9

### 缺陷修正

- 修正 v1.0.8 引入的手推车无法保存以及无法发送邮件的问题

-------------------------------------------------------------------------------

## [v1.0.8] - `2020-11-20`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.0.8_main.sql`

### 新增功能

- 实现支持多种单位的持久光环机制 (#324)
- 优化对极端计算的支持 (AKA: 变态服拓展包) (#326)
- 实现 `OnPCBuffStartExpress` 实时事件, 当玩家成功获得一个状态(Buff)后触发 (#329)
- 实现 `OnPCBuffStartFilter` 过滤器, 当玩家即将获得一个状态(Buff)时触发 (#329)
- 实现 `OnPCBuffEndExpress` 实时事件, 当玩家成功解除一个状态(Buff)后触发 (#330)

### 功能调整

- 使 Windows 环境下辅助脚本更容易被使用 (#325)
- 优化地图服务器启动时的加载速度 (#327)

-------------------------------------------------------------------------------

## [v1.0.7] - `2020-09-13`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.0.7_main.sql`
- 若启用 `SQL` 版本的魔物/物品数据库, 那么请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.0.7_main_use_sql_db.sql`
- 请在日志数据库导入:
	- `sql-files\logs\upgrades\upgrade_to_1.0.7_logs.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 特别提示

- 从该版本开始熊猫模拟器已支持 `20200401` 客户端, 但您需要自己修正 `PACKETVER` 并编译
- 考虑到目前大多数人没有稳定的 2020 客户端, 继续使用 `20180620` 作为默认客户端版本
- 该版本服务端侧已经支持 21 亿的物品编号, 但需要与客户端配套才能使用
- 经测试 `201806020` 的客户端并不支持超过 32767 的物品编号
- 基于 `RagexeRE` 制作的客户端版本 >= `20180704` 即可支持超过 32767 的物品编号
- 基于 `Ragexe` 制作的客户端版本 >= `20181121` 即可支持超过 32767 的物品编号
- 该版本中 rAthena 实装了 KRO 的职业调整, 会有大量技能效果变更, 附 KRO 更新日志:
	- [基因学者 - 2019.12.04](https://ro.gnjoy.com/news/update/View.asp?seq=246&curpage=1)
	- [人工生命体技能 - 2017.10.25](https://ro.gnjoy.com/news/event/View.asp?Seq=784&kind=A&curpage=1)
	- [修罗 - 2019.04.15](https://ro.gnjoy.com/news/notice/View.asp?seq=7099)
	- [日影忍者/月影忍者 - 2019.02.25](https://ro.gnjoy.com/news/notice/View.asp?BBSMode=10001&seq=7081)
	- [反叛者 - 2019.02.25](https://ro.gnjoy.com/news/notice/View.asp?BBSMode=10001&seq=7081)
	- [超级初学者 - 2019.02.25](https://ro.gnjoy.com/news/notice/View.asp?BBSMode=10001&seq=7081)
	- [吟游诗人/流浪舞姬 - 第一部分 - 2019.04.15](https://ro.gnjoy.com/news/update/View.asp?seq=235&curpage=1)
	- [吟游诗人/流浪舞姬 - 第二部分 - 2019.12.04](https://ro.gnjoy.com/news/update/View.asp?seq=246&curpage=1)
	- [十字刺客 - 2019.10.15](http://ro.gnjoy.com/news/update/View.asp?seq=243&curpage=1)
	- [大法师 - 2019.07.16](https://ro.gnjoy.com/news/update/View.asp?seq=239&curpage=1)
	- [卢恩骑士 - 第二部分 - 2019.10.15](https://ro.gnjoy.com/news/update/View.asp?seq=243&curpage=1)
	- [卢恩骑士 - 第一部分(早在2017年就已实装, 并非本次更新) - 2017.04.06](https://ro.gnjoy.com/news/devnote/View.asp?category=1&seq=3708477&curpage=1)
	
### 新增功能

- 实现 `nohomun` 地图标记, 用于禁止在指定地图召唤人工生命体 (#315)
- 实现 `nomerc` 地图标记, 用于禁止在指定地图召唤佣兵 (#316)
- 实现 `noskill2` 地图标记, 用于限制指定类型的单位在地图上使用技能 (#317)
- 实现 `getconstant` 脚本指令, 用于查询一个常量字符串对应的数值 (#318)
- 使 `getiteminfo` 可获取物品使用脚本/装备脚本/卸装脚本的内容 (#319)
- 实现 `preg_search` 脚本指令, 用于执行一个正则表达式搜索并返回匹配的分组内容 (#320)
- 使服务端能够读取 SSO 方式登录的用户本地 MAC 地址 (#309)

### 功能调整

- 解除 `statuscheck` 脚本指令 `@sc_tickleft` 返回值的上限
- 使用 `pipenv` 对辅助脚本的依赖库进行管理维护 (合理性和使用难度同时提高) (#311)
- 汉化部分服务器消息文件和帮助文档 (#307)

### 缺陷修正

- 处理 `Windows 10` 的 `UTF8` 编码选项带来的中文乱码问题 (#301)
- 修正部分情况下魔物会被随机传送或者卡住无法移动的问题 (感谢"张大坏"反馈) (#292)
- 修正 Liunx 环境下因为编码自适应导致的崩溃问题 (#298)
- 修正部分装备无法在背包和装备面板中显示的问题 (感谢"喵了个咪"反馈) (#303)
- 修正点击副本销毁按钮可能会导致地图服务器无响应的问题 (感谢"喵了个咪"反馈)
- 修正一些已知会导致崩溃的情况 (感谢"张大坏"反馈) (#308)
- 修正多层脚本堆栈备份恢复时的一处错误 (#312)
- 修正当 `block_free` 存在重复指针时的无效指针的问题 (感谢"喵了个咪"反馈) (#313)

-------------------------------------------------------------------------------

## [v1.0.6] - `2020-06-11`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.0.6_main.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 使离线挂店或挂机角色可以被 `recall` 指令独立召唤 (#279)
- 实现 `nopet` 地图标记的功能, 可以在指定地图上禁止宠物 (#281)
- 实现 `setinventoryinfo` 脚本指令, 用于设置指定背包序号道具的部分详细信息 (#283) (#288)
- 使 `getinventoryinfo / setinventoryinfo` 可设置道具的绑定类型 (#289)

### 功能调整

- 优化使用 `@version` 指令的回显信息 (#268)
- 打包时能够将物品和魔物名称转译成简体或繁体中文 (感谢"moonsun"提供译本) (#266)
- 使非 Windows 10 操作系统可以正常生成转储文件 (#271)
- 能够支持根据系统语言读取对应的消息文件 (#282)
- 整理数据库创建脚本的目录结构, 使之更加合理 (#286)

### 缺陷修正

- 修正 BOSS 雷达可能会地图服务器崩溃的问题 (感谢"小紀"反馈) (#267)
- 修正使用离线挂机系列指令会卡住公会仓库的问题 (感谢"喵了个咪"反馈) (#269)
- 修正魔物道具固定掉率数据库的 `StrictFixed` 字段无效的问题 (感谢 "张大坏" 反馈) (#272)
- 修正离线挂机/挂店的角色在服务器重启自动上线后头饰外观会暂时丢失的问题 (感谢 "张大坏" 反馈) (#273)
- 修正无效的技能编号可能导致潜在的地图服务器崩溃 (#276)
- 修正关闭地图服务器时若有副本正在运行时可能会导致崩溃的问题 (#277)
- 修正 `reloadscript` 可能会导致地图服务器崩溃的问题 (感谢"小紀"反馈) (#285)

-------------------------------------------------------------------------------

## [v1.0.5] - `2020-04-20`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.0.5_main.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

### 新增功能

- 拓展离线挂机的不同种类, 延展出离线挂机模式和离开模式 (#260)

### 功能调整

- 与 MySQL 数据库建立连接时主动禁用 SSL 模式 (#257)
- 将第三方组件模块 `libmysql.dll` 升级到 6.1.11 版本 (#258)
- 汉化部分行为明确的战斗配置选项描述和说明 (#261)
- 使公会的初始人数和扩充组合体制每级增加人数可被宏定义 (#262)
- 调整战斗配置选项与服务端不匹配时的一些错误提示 (#265)

### 缺陷修正

- 修正 `nomail` 地图标记存在部分功能失效的问题 (#259)
- 修正使用 `delchar` 脚本指令会导致地图服务器崩溃的问题 (#263)
- 修正读取 UTF8-BOM 编码的文件时可能出现多余的空行 (#264)

-------------------------------------------------------------------------------

## [v1.0.4] - `2020-03-23`

### 新增功能

- 添加 rAthenaCN 1.8.0 到熊猫模拟器的数据库升级脚本 (#251)
- 实现队长副本信息窗口中"销毁副本"按钮的功能 (#255)

### 缺陷修正

- 修正 `item_properties.yml` 部分设置无效的问题 (#252)
- 修正读取 `pet_db.yml` 可能导致的内存泄露 (#253)
- 修正 `getinventoryinfo` 获取道具 `unique_id` 错误的问题 (#254)

-------------------------------------------------------------------------------

## [v1.0.3] - `2020-03-12`

### 升级提示

- 请在主数据库导入:
	- `sql-files\main\upgrades\upgrade_to_1.0.3_main.sql`

> 导入之前请打开 `sql` 文件查看顶部的注释信息, 通常会有一些导入顺序的建议.
> 请养成升级数据库之前备份的好习惯, 因为升级脚本并未经过大规模测试!!

- 由于 `Boost` 依赖项目变化, 请使用源码的同学重新编译 `3rdparty\boost` 工程
- 本次 `rAthena` 官方整合了多个技能数据文件到 `skill_db.yml` 单文件中
- 使用 `csv2yaml.exe` 可以将 `txt` 数据文件升级为 `yml` 格式的数据文件
- 你在 `conf\msg_conf\import\` 目录中用不到的 `map_msg_*_conf.txt` 可以删掉了

### 新增功能

- 实现终端信息翻译机制, 可跨平台自动适配英文、简体和繁体中文 (#226)
- 使战斗配置选项可限制玩家在 PVP 地图上的最大攻速 (#238)
- 使战斗配置选项可限制玩家在 GVG 地图上的最大攻速 (#239)
- 使 `item_properties.yml` 数据库能够屏蔽特定场景下的道具外观 (#236)
- 使 `item_properties.yml` 数据库能够设置高优先级的公告策略 (#244)
- 使战斗配置选项可控制玩家无权使用管理员指令时的处理方式 (#241)
- 使 `getsameipinfo` 指令能够支持指定地图 (#228)
- 实现 `storagegetitem` 脚本指令, 能够往仓库直接创造指定道具 (#233)

### 功能调整

- 使 `MAX_INVENTORY` 能够支持超过 128 的值 (#234)
- 归纳数据库升级脚本以便简化用户的升级操作, 请见 `sql-files` 目录 (#240)
- 优化读取物品数据库等几个比较明显的性能问题 (#229)
- 对消息文件的引入层级和关系进行梳理 (#243)
- 翻译登录, 角色, 地图服务器的主要配置文件 (#225)

### 缺陷修正

- 修正公会旗帜获取图标时提示 `map_getmapflag` 错误的问题 (感谢"小紀"反馈) (#231)
- 解决中文角色名在 Linux 终端上显示乱码的问题 (#227)
- 避免在 Windows 上部署 `import-tmpl` 目录时的冲突警告 (#237)
- 修正加载 `skill_db.yml` 潜在的一处崩溃问题 (#245)

-------------------------------------------------------------------------------

## [v1.0.2] - `2019-11-29`

### 新增功能

- 实现 `selfdeletion` 脚本指令, 用于控制 NPC 在特定时机进行自毁 (#212)
- 实现 `npcexists` 脚本指令, 用于判断指定名称的 NPC 是否存在 (#220)
- 实现 `script4each` 系列指令使之能够支持调用事件标签 (#206)

### 功能调整

- 生成项目时若发现未编译 Boost 则会终止生成并给出操作提示 (#207)

### 缺陷修正

- 修正在部分 CPU 上运行 `VS2019 16.3` 编译出来的程序会崩溃的问题 (#210)
- 修正在 NPC 事件脚本代码中执行 `unloadnpc` 会导致地图服务器崩溃的问题 (#211)
- 跟随 a64a77b 修正语法解析判断的准确性问题 (感谢"Jian916"指出) (#208)
- 修正无法将转储文件发送到分析服务器的问题 (Part of #205)

-------------------------------------------------------------------------------

## [v1.0.1] - `2019-11-03`

### 新增功能

- 实现 `multicatchpet` 脚本指令, 能够指定多个希望捕捉的魔物 (#189)
- 实现与装备穿脱相关的两个常规事件和两个过滤事件 (#191)
- 实现 `@crashtest` 管理员指令, 用于触发崩溃以便测试崩溃上报机制 (#193)
- 实现 `force_loadevent` 选项, 用于强制全部地图触发 `OnPCLoadMapEvent` 事件 (#194)
- 实现 `force_identified` 选项, 用于控制部分渠道创造的装备可直接变成已鉴定状态 (#196)
- 实现 `cashmount_useitem_limit` 选项, 用于限制使用 `商城坐骑` 时使用的道具类型 (#197)
- 实现 `script4eachmob` 和 `script4eachnpc` 脚本指令 (#201)

### 功能调整

- 拓展 `copynpc` 使其支持七个参数, 降低理解成本 (#190)
- 使 `script4each` 系列指令的 <脚本> 参数可以忽略最外层的大括号 (#200)

### 缺陷修正

- 修正启用多层脚本堆栈后会导致 `doevent` 表现异常的问题 (#185)
- 修正被中文紧挨着的待转义双引号无法通过语法检测的问题 (#203)

-------------------------------------------------------------------------------

## [v1.0.0] - `2019-10-07`

### 新增功能

- 能够读取 `UTF8-BOM` 编码的 db, npc, conf 文件 (0a0606c)
- 实现护身符类型的道具, 只要道具在身上就能持续发挥效果 (#112)
- 实现魔物道具固定掉率数据库, 可用于设置道具的全局固定掉落概率 (#119)
- 使 `pointshop` 类型的商店能支持指定变量别名, 改善玩家的游戏体验 (#126)
- 使用 `Google Breakpad` 捕捉程序的崩溃转储文件 (#150)
- 能够检测 `import` 目录是否存在, 若不存在能自动复制一份出来 (#173)
- 重新梳理数据库连接配置并重写编码自动判定策略 (#174)
- 能够在 `map_athena.conf` 中设置封包混淆密钥 (a8d9e84)
- 能够在 `login_athena.conf` 中设置隐藏角色服务器的在线人数 (9291f57)
- 能够在 `char_athena.conf` 中设置禁止创建杜兰族角色 (30bfe00)
- 实现或拓展共计  1 个 GM 指令, 详见 `doc/pandas_atcommands.txt` 指令文档
- 实现或拓展共计 40 个脚本指令, 详见 `doc/pandas_script_commands.txt` 指令文档
- 实现或拓展共计 12 个地图标记, 详见 `doc/pandas_mapflags.txt` 说明文档
- 实现或拓展共计 15 个脚本事件, 详见 `doc/pandas_events.txt` 说明文档

### 功能调整

- 使影子装备可以支持插卡, 而不会因插卡而被强制转换成普通道具 (#64)
- 在使用 `_M/_F` 注册的时候, 能够限制使用中文等字符作为游戏账号 (09068b8)

### 缺陷修正

- 修正读取 `exp_homun.txt` 时提示信息不正确的问题 (#17)
- 修正部分简体、繁体中文字符作为角色名时, 会被变成问号的问题 (#50)
- 修正 `item_trade` 中限制物品掉落后, 权限足够的 GM 也无法绕过限制的问题 (#54)
- 修正使用 `sommon` 脚本指令召唤不存在的魔物, 会导致地图服务器崩溃的问题 (#65)
- 修正给予 `instance_create` 无效的副本名称会导致地图服务器崩溃的问题 (#113)
- 修正 `reloadnpc` 时文件路径前后有空格所带来的不良影响 (#139)
- 修正使用 `pointshop` 操作 `#CASHPOINTS` 变量时可能导致的双花攻击的问题 (#138)
- 修正多层脚本调用导致的程序崩溃问题 (#163)
- 修正部分情况下 `getd` 脚本指令会导致地图服务器崩溃的问题 (#175)
- 修正在部分情况下角色公会图标刷新不及时的问题 (663b9d4)

-------------------------------------------------------------------------------

[v1.2.1]: https://github.com/PandasWS/Pandas/compare/v1.2.0...v1.2.1
[v1.2.0]: https://github.com/PandasWS/Pandas/compare/v1.1.19...v1.2.0
[v1.1.19]: https://github.com/PandasWS/Pandas/compare/v1.1.18...v1.1.19
[v1.1.18]: https://github.com/PandasWS/Pandas/compare/v1.1.17...v1.1.18
[v1.1.17]: https://github.com/PandasWS/Pandas/compare/v1.1.16...v1.1.17
[v1.1.16]: https://github.com/PandasWS/Pandas/compare/v1.1.15...v1.1.16
[v1.1.15]: https://github.com/PandasWS/Pandas/compare/v1.1.14...v1.1.15
[v1.1.14]: https://github.com/PandasWS/Pandas/compare/v1.1.13...v1.1.14
[v1.1.13]: https://github.com/PandasWS/Pandas/compare/v1.1.12...v1.1.13
[v1.1.12]: https://github.com/PandasWS/Pandas/compare/v1.1.11...v1.1.12
[v1.1.11]: https://github.com/PandasWS/Pandas/compare/v1.1.10...v1.1.11
[v1.1.10]: https://github.com/PandasWS/Pandas/compare/v1.1.9...v1.1.10
[v1.1.9]: https://github.com/PandasWS/Pandas/compare/v1.1.8...v1.1.9
[v1.1.8]: https://github.com/PandasWS/Pandas/compare/v1.1.7...v1.1.8
[v1.1.7]: https://github.com/PandasWS/Pandas/compare/v1.1.6...v1.1.7
[v1.1.6]: https://github.com/PandasWS/Pandas/compare/v1.1.5...v1.1.6
[v1.1.5]: https://github.com/PandasWS/Pandas/compare/v1.1.4...v1.1.5
[v1.1.4]: https://github.com/PandasWS/Pandas/compare/v1.1.3...v1.1.4
[v1.1.3]: https://github.com/PandasWS/Pandas/compare/v1.1.2...v1.1.3
[v1.1.2]: https://github.com/PandasWS/Pandas/compare/v1.1.1...v1.1.2
[v1.1.1]: https://github.com/PandasWS/Pandas/compare/v1.1.0...v1.1.1
[v1.1.0]: https://github.com/PandasWS/Pandas/compare/v1.0.9...v1.1.0
[v1.0.9]: https://github.com/PandasWS/Pandas/compare/v1.0.8...v1.0.9
[v1.0.8]: https://github.com/PandasWS/Pandas/compare/v1.0.7...v1.0.8
[v1.0.7]: https://github.com/PandasWS/Pandas/compare/v1.0.6...v1.0.7
[v1.0.6]: https://github.com/PandasWS/Pandas/compare/v1.0.5...v1.0.6
[v1.0.5]: https://github.com/PandasWS/Pandas/compare/v1.0.4...v1.0.5
[v1.0.4]: https://github.com/PandasWS/Pandas/compare/v1.0.3...v1.0.4
[v1.0.3]: https://github.com/PandasWS/Pandas/compare/v1.0.2...v1.0.3
[v1.0.2]: https://github.com/PandasWS/Pandas/compare/v1.0.1...v1.0.2
[v1.0.1]: https://github.com/PandasWS/Pandas/compare/v1.0.0...v1.0.1
[v1.0.0]: https://github.com/PandasWS/Pandas/releases/tag/v1.0.0

[Microsoft Visual C++ 2015 Redistributable]: https://www.microsoft.com/zh-CN/download/details.aspx?id=52685
